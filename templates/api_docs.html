<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Dokümantasyonu</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='api.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Flask REST API</h1>
            <p>Todo Yönetim API Dokümantasyonu</p>
        </header>

        <nav>
            <a href="/">Ana Sayfa</a>
            <a href="/api/docs" class="active">API Docs</a>
        </nav>

        <main>
            <section class="endpoint">
                <h2>Tüm Todo'ları Getir</h2>
                <div class="method get">GET</div>
                <code>/api/todos</code>
                <button onclick="testAPI('GET', '/api/todos')">Test Et</button>
                <pre class="response">Response:
{
  "success": true,
  "data": [...],
  "count": 2
}</pre>
            </section>

            <section class="endpoint">
                <h2>Tek Todo Getir</h2>
                <div class="method get">GET</div>
                <code>/api/todos/&lt;id&gt;</code>
                <button onclick="testAPI('GET', '/api/todos/1')">Test Et</button>
                <pre class="response">Response:
{
  "success": true,
  "data": {...}
}</pre>
            </section>

            <section class="endpoint">
                <h2>Yeni Todo Oluştur</h2>
                <div class="method post">POST</div>
                <code>/api/todos</code>
                <pre class="request">Body:
{
  "title": "Yeni görev",
  "completed": false
}</pre>
                <button onclick="testCreate()">Test Et</button>
            </section>

            <section class="endpoint">
                <h2>Todo Güncelle</h2>
                <div class="method put">PUT</div>
                <code>/api/todos/&lt;id&gt;</code>
                <pre class="request">Body:
{
  "title": "Güncellenmiş görev",
  "completed": true
}</pre>
                <button onclick="testUpdate()">Test Et</button>
            </section>

            <section class="endpoint">
                <h2>Todo Sil</h2>
                <div class="method delete">DELETE</div>
                <code>/api/todos/&lt;id&gt;</code>
                <button onclick="testAPI('DELETE', '/api/todos/2')">Test Et</button>
            </section>

            <section class="endpoint">
                <h2>İstatistikler</h2>
                <div class="method get">GET</div>
                <code>/api/stats</code>
                <button onclick="testAPI('GET', '/api/stats')">Test Et</button>
                <pre class="response">Response:
{
  "success": true,
  "data": {
    "total": 2,
    "completed": 1,
    "pending": 1
  }
}</pre>
            </section>

            <div id="result"></div>
        </main>

        <footer>
            <p>© 2025 Flask REST API | Made with Python & Flask</p>
        </footer>
    </div>

    <script>
        async function testAPI(method, endpoint) {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="loading">⏳ İstek gönderiliyor...</div>';
            
            try {
                const response = await fetch(endpoint, { method });
                const data = await response.json();
                
                result.innerHTML = `
                    <div class="result-box success">
                        <h3>Sonuç (${response.status})</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result-box error">
                        <h3>❌ Hata</h3>
                        <pre>${error.message}</pre>
                    </div>
                `;
            }
        }

        async function testCreate() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="loading">⏳ Todo oluşturuluyor...</div>';
            
            try {
                const response = await fetch('/api/todos', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        title: 'API Test Todo',
                        completed: false
                    })
                });
                const data = await response.json();
                
                result.innerHTML = `
                    <div class="result-box success">
                        <h3>✅ Oluşturuldu (${response.status})</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result-box error">
                        <h3>❌ Hata</h3>
                        <pre>${error.message}</pre>
                    </div>
                `;
            }
        }

        async function testUpdate() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="loading">⏳ Todo güncelleniyor...</div>';
            
            try {
                const response = await fetch('/api/todos/1', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        title: 'Güncellenmiş Todo',
                        completed: true
                    })
                });
                const data = await response.json();
                
                result.innerHTML = `
                    <div class="result-box success">
                        <h3>✅ Güncellendi (${response.status})</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                result.innerHTML = `
                    <div class="result-box error">
                        <h3>❌ Hata</h3>
                        <pre>${error.message}</pre>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
